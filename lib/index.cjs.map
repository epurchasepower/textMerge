{"version":3,"file":"index.cjs","sources":["../src/index.js"],"sourcesContent":["import numbro from 'numbro'\n\nconst TERM_RE = /\\[(\\w+(\\/\\w+)?)\\]/g\nconst PRONOUNS = {\n  i: {\n    they: 'I',\n    them: 'me',\n    their: 'my',\n    theirs: 'mine',\n    themselves: 'myself',\n  },\n  he: {\n    they: 'he',\n    them: 'him',\n    their: 'his',\n    theirs: 'his',\n    themselves: 'himself',\n  },\n  she: {\n    they: 'she',\n    them: 'her',\n    their: 'her',\n    theirs: 'hers',\n    themselves: 'herself',\n  },\n  they: {\n    they: 'they',\n    them: 'them',\n    their: 'their',\n    theirs: 'theirs',\n    themselves: 'themselves',\n  },\n  we: {\n    they: 'we',\n    them: 'us',\n    their: 'our',\n    theirs: 'ours',\n    themselves: 'ourselves',\n  },\n}\n\n/*\n * Someday we'll allow the user to pass in a locale, and we'll have\n *  style options keyed by part of the merge term, like [value:currency]\n *  or [value:scientific].\n * For now, everyone is US, with commas and 2 digits after the decimal point\n */\n\nconst formatNumber = (val) =>\n  numbro(val).format({thousandSeparated: true, mantissa: 2, optionalMantissa: true})\n\nexport default (template, terms, preferredPronoun,missing) => {\n  let result = ''\n  let lastIndex = 0\n  let match\n  if (preferredPronoun && preferredPronoun in PRONOUNS) {\n    terms = {\n      ...PRONOUNS[preferredPronoun],\n      ...terms,\n    }\n  }\n\n  while ((match = TERM_RE.exec(template)) !== null) {\n    result += template.substring(lastIndex, match.index)\n    const term = match[1].charAt(0).toLowerCase() + match[1].substring(1)\n    if (!(term in terms)) {\n      term = match[1]\n    }\n    let val\n    let index\n    if (term in terms) {\n      val = terms[term]\n    } else if (preferredPronoun && (index = term.indexOf('/')) > 0) {\n      if (preferredPronoun === 'they' || preferredPronoun === 'we') {\n        val = term.substring(0, index)\n      } else {\n        val = term.substring(index + 1)\n      }\n    } else {\n      val = match[0]\n        if (missing){\n        missing.push(term)\n      }\n    }\n    if (typeof val === 'number') {\n      val = formatNumber(val)\n    } else if (term !== match[1]) {\n      val = val.charAt(0).toUpperCase() + val.slice(1)\n    }\n    result += val\n    lastIndex = match.index + match[0].length\n  }\n  result += template.substring(lastIndex)\n\n  return result\n}\n"],"names":[],"mappings":"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"}